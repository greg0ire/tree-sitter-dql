================================================================================
JOIN query
================================================================================

SELECT u, a FROM User u JOIN u.articles a

--------------------------------------------------------------------------------

(QueryLanguage
  (SelectStatement
    (SelectClause
      (SelectExpression
        (ScalarExpression
          (SimpleArithmeticExpression
            (ArithmeticTerm
              (ArithmeticFactor
                (ArithmeticPrimary
                  (ResultVariable
                    (identifier))))))))
      (SelectExpression
        (ScalarExpression
          (SimpleArithmeticExpression
            (ArithmeticTerm
              (ArithmeticFactor
                (ArithmeticPrimary
                  (ResultVariable
                    (identifier)))))))))
    (FromClause
      (IdentificationVariableDeclaration
        (RangeVariableDeclaration
          (AbstractSchemaName
            (identifier))
          (AliasIdentificationVariable
            (identifier)))
        (Join
          (JoinAssociationDeclaration
            (JoinAssociationPathExpression
              (IdentificationVariable
                (identifier))
              (CollectionValuedAssociationField
                (FieldIdentificationVariable
                  (identifier))))
            (AliasIdentificationVariable
              (identifier))))))))

================================================================================
Association JOIN with WITH keyword
================================================================================

SELECT u, a FROM User u LEFT JOIN u.articles a WITH a.published = true

--------------------------------------------------------------------------------

(QueryLanguage
  (SelectStatement
    (SelectClause
      (SelectExpression
        (ScalarExpression
          (SimpleArithmeticExpression
            (ArithmeticTerm
              (ArithmeticFactor
                (ArithmeticPrimary
                  (ResultVariable
                    (identifier))))))))
      (SelectExpression
        (ScalarExpression
          (SimpleArithmeticExpression
            (ArithmeticTerm
              (ArithmeticFactor
                (ArithmeticPrimary
                  (ResultVariable
                    (identifier)))))))))
    (FromClause
      (IdentificationVariableDeclaration
        (RangeVariableDeclaration
          (AbstractSchemaName
            (identifier))
          (AliasIdentificationVariable
            (identifier)))
        (Join
          (JoinAssociationDeclaration
            (JoinAssociationPathExpression
              (IdentificationVariable
                (identifier))
               (CollectionValuedAssociationField
                 (FieldIdentificationVariable
                   (identifier))))
            (AliasIdentificationVariable
              (identifier)))
          (ConditionalExpression
            (ConditionalTerm
              (ConditionalFactor
                (ConditionalPrimary
                  (SimpleConditionalExpression
                    (ComparisonExpression
                      (ArithmeticExpression
                        (SimpleArithmeticExpression
                          (ArithmeticTerm
                            (ArithmeticFactor
                              (ArithmeticPrimary
                                (SingleValuedPathExpression
                                  (StateFieldPathExpression
                                  (IdentificationVariable
                                    (identifier))
                                        (StateField
                                          (SimpleStateField
                                            (FieldIdentificationVariable
                                              (identifier)))))))))))
                          (ComparisonOperator)
                          (ArithmeticExpression
                            (SimpleArithmeticExpression
                              (ArithmeticTerm
                                (ArithmeticFactor
                                  (ArithmeticPrimary
                                    (Literal
                                      (boolean))))))))))))))))))

================================================================================
Arbitrary JOIN with ON keyword
================================================================================

SELECT u FROM User u JOIN Banlist b ON u.email = b.email

--------------------------------------------------------------------------------

    (QueryLanguage
      (SelectStatement
        (SelectClause
          (SelectExpression
            (ScalarExpression
              (SimpleArithmeticExpression
                (ArithmeticTerm
                  (ArithmeticFactor
                    (ArithmeticPrimary
                      (ResultVariable
                        (identifier)))))))))
        (FromClause
          (IdentificationVariableDeclaration
            (RangeVariableDeclaration
              (AbstractSchemaName
                (identifier))
              (AliasIdentificationVariable
                (identifier)))
            (Join
              (RangeVariableDeclaration
                (AbstractSchemaName
                  (identifier))
                (AliasIdentificationVariable
                  (identifier)))
              (ConditionalExpression
                (ConditionalTerm
                  (ConditionalFactor
                    (ConditionalPrimary
                      (SimpleConditionalExpression
                        (ComparisonExpression
                          (ArithmeticExpression
                            (SimpleArithmeticExpression
                              (ArithmeticTerm
                                (ArithmeticFactor
                                  (ArithmeticPrimary
                                    (SingleValuedPathExpression
                                      (StateFieldPathExpression
                                        (IdentificationVariable
                                          (identifier))
                                        (StateField
                                          (SimpleStateField
                                            (FieldIdentificationVariable
                                              (identifier)))))))))))
                          (ComparisonOperator)
                          (ArithmeticExpression
                            (SimpleArithmeticExpression
                              (ArithmeticTerm
                                (ArithmeticFactor
                                  (ArithmeticPrimary
                                    (SingleValuedPathExpression
                                      (StateFieldPathExpression
                                        (IdentificationVariable
                                          (identifier))
                                        (StateField
                                          (SimpleStateField
                                            (FieldIdentificationVariable
                                              (identifier))))))))))))))))))))))

================================================================================
Arbitrary JOIN with WITH keyword (backward compatibility)
================================================================================

SELECT u FROM User u JOIN Banlist b WITH u.email = b.email

--------------------------------------------------------------------------------

(QueryLanguage
  (SelectStatement
    (SelectClause
      (SelectExpression
        (ScalarExpression
          (SimpleArithmeticExpression
            (ArithmeticTerm
              (ArithmeticFactor
                (ArithmeticPrimary
                  (ResultVariable
                    (identifier)))))))))
    (FromClause
      (IdentificationVariableDeclaration
        (RangeVariableDeclaration
          (AbstractSchemaName
            (identifier))
          (AliasIdentificationVariable
            (identifier)))
        (Join
          (RangeVariableDeclaration
            (AbstractSchemaName
              (identifier))
            (AliasIdentificationVariable
              (identifier)))
          (ConditionalExpression
            (ConditionalTerm
              (ConditionalFactor
                (ConditionalPrimary
                  (SimpleConditionalExpression
                    (ComparisonExpression
                      (ArithmeticExpression
                        (SimpleArithmeticExpression
                          (ArithmeticTerm
                            (ArithmeticFactor
                              (ArithmeticPrimary
                                (SingleValuedPathExpression
                                   (StateFieldPathExpression
                                     (IdentificationVariable
                                       (identifier))
                                      (StateField
                                        (SimpleStateField
                                          (FieldIdentificationVariable
                                            (identifier)))))))))))
                       (ComparisonOperator)
                       (ArithmeticExpression
                         (SimpleArithmeticExpression
                           (ArithmeticTerm
                             (ArithmeticFactor
                               (ArithmeticPrimary
                                 (SingleValuedPathExpression
                                   (StateFieldPathExpression
                                     (IdentificationVariable
                                       (identifier))
                                     (StateField
                                       (SimpleStateField
                                         (FieldIdentificationVariable
                                           (identifier))))))))))))))))))))))

================================================================================
Subquery in WHERE clause
================================================================================

SELECT u FROM User u WHERE u.id IN (SELECT a.userId FROM Article a WHERE a.published = true)

--------------------------------------------------------------------------------

(QueryLanguage
  (SelectStatement
    (SelectClause
      (SelectExpression
        (ScalarExpression
          (SimpleArithmeticExpression
            (ArithmeticTerm
              (ArithmeticFactor
                (ArithmeticPrimary
                  (ResultVariable
                    (identifier)))))))))
    (FromClause
      (IdentificationVariableDeclaration
        (RangeVariableDeclaration
          (AbstractSchemaName
            (identifier))
          (AliasIdentificationVariable
            (identifier)))))
    (WhereClause
      (ConditionalExpression
        (ConditionalTerm
          (ConditionalFactor
            (ConditionalPrimary
              (SimpleConditionalExpression
                (InExpression
                  (ArithmeticExpression
                    (SimpleArithmeticExpression
                      (ArithmeticTerm
                        (ArithmeticFactor
                          (ArithmeticPrimary
                            (SingleValuedPathExpression
                              (StateFieldPathExpression
                                (IdentificationVariable
                                  (identifier))
                                (StateField
                                  (SimpleStateField
                                    (FieldIdentificationVariable
                                      (identifier)))))))))))
                  (Subselect
                    (SimpleSelectClause
                      (SimpleSelectExpression
                        (StateFieldPathExpression
                          (IdentificationVariable
                            (identifier))
                          (StateField
                            (SimpleStateField
                              (FieldIdentificationVariable
                                (identifier)))))))
                    (SubselectFromClause
                      (SubselectIdentificationVariableDeclaration
                        (IdentificationVariableDeclaration
                          (RangeVariableDeclaration
                            (AbstractSchemaName
                              (identifier))
                            (AliasIdentificationVariable
                              (identifier))))))
                    (WhereClause
                      (ConditionalExpression
                        (ConditionalTerm
                          (ConditionalFactor
                            (ConditionalPrimary
                              (SimpleConditionalExpression
                                (ComparisonExpression
                                  (ArithmeticExpression
                                    (SimpleArithmeticExpression
                                      (ArithmeticTerm
                                        (ArithmeticFactor
                                          (ArithmeticPrimary
                                            (SingleValuedPathExpression
                                              (StateFieldPathExpression
                                                (IdentificationVariable
                                                  (identifier))
                                                (StateField
                                                  (SimpleStateField
                                                    (FieldIdentificationVariable
                                                      (identifier)))))))))))
                                  (ComparisonOperator)
                                  (ArithmeticExpression
                                    (SimpleArithmeticExpression
                                      (ArithmeticTerm
                                        (ArithmeticFactor
                                          (ArithmeticPrimary
                                            (Literal
                                              (boolean))))))))))))))))))))))))
